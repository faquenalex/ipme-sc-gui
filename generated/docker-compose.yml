version: '3.3'
services:
    lancache-autofill:
        image: 'ubuntu:18.10'
        container_name: cache-lancache-autofill
        environment:
            - PUID=1000
            - PGID=1000
            - TZ=Europe/Berlin
            - DOWNLOADS_DIRECTORY=/data
            - STEAMCMD_PATH=/usr/games/steam/steamcmd.sh
            - DEFAULT_STEAM_USER=steamIPME
            - DEBIAN_FRONTEND=noninteractive
            - DEBCONF_NONINTERACTIVE_SEEN=true
        command: 'bash /scripts/bootstrap.sh'
        volumes:
            - 'lancache-autofill:/data'
            - './overlays/lancache/scripts:/scripts'
        ports:
            - '8000:80'
    cache-proxy-service:
        image: nginx
        container_name: cache-proxy-service
        ports:
            - '80:80'
        volumes:
            - './overlays/cache-proxy-service/etc/nginx/conf.d/default.conf:/etc/nginx/conf.d/default.conf'
    cache-dns-01:
        image: 'steamcache/steamcache-dns:latest'
        container_name: cache-dns-01
        environment:
            - STEAMCACHE_IP=192.168.1.34
        depends_on:
            - cache-proxy-service
            - lancache-autofill
        ports:
            - '53:53/udp'
volumes:
    lancache-autofill: {  }
